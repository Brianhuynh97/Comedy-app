<% if @show.photo.attached? %>
  <div class="banner" style="background-image: linear-gradient(rgba(0,0,0,0.4),rgba(0,0,0,0.4)), url('<%= cl_image_path @show.photo.key, height: 300, crop: :scale %>')">
    <div class="container">
      <h1 class="d-flex justify-content-center"><%= @show.title %></h1>
    </div>
  </div>
<% else %>
  <div class="banner" style="background-image: linear-gradient(rgba(0,0,0,0.4),rgba(0,0,0,0.4)), url('https://source.unsplash.com/random/?comedy-show')">
  <div class="container">
    <h1 class="d-flex justify-content-center"><%= @show.title %></h1>
  </div>
</div>
<% end %>


<section class="bg-white rounded p-5 my-5 container w-75">

  <div>
    <h4><%= @show.description %></h4>
  </div>

  <div class=" mt-5 card-trip-infos">
    <table>
      <tbody>
        <tr>
          <td><h4> <i class="fa fa-calendar" aria-hidden="true"></i></h4></td>
          <td><h4> &nbsp; The show is on: <%= @show.datetime.strftime("%d/%m/%Y %H:%M") %> </h4></td>
        </tr>
        <tr>
          <td><h4> <i class="fa fa-thumbs-up" aria-hidden="true"></i></h4></td>
          <td><h4> &nbsp; The ticket price is <%= @show.price %> AUD</h4></td>
        </tr>
      </tbody>
    </table>
  </div>
  <h3 class="mt-3"> Book the show today </h3>
  <h5><%= @available_seats%> seats remaining</h5>
  <%= simple_form_for [ @show, @booking ] do |f| %>
    <%= f.input :seat_quantity, as: :string, required: true %>
    <%= f.submit "Confirm Booking", class: "btn btn-success btn-lg" %>
  <% end %>

  <div class=" my-5">
    <h3>Leave a review</h3>
    <%= simple_form_for [@show, @review] do |f| %>
      <%= f.input :rating %>
      <%= f.input :comment %>
      <%= f.button :submit, class: "btn btn-success btn-lg"%>
    <% end %>
  </div>

  <h4 class="mt-5 d-flex justify-content-between">Reviews</h4>
  <% if !@reviews.empty? %>
      <% @reviews.each do |review| %>
        <div class="card bg-light rounded mt-2 p-3 d-flex justify-content-center">
          <p><%= review.comment %> - Rating: <%= review.rating %> <%= link_to ('<i class="fa-solid fa-trash-can"></i>').html_safe,
                review_path(review),
                method: :delete,
                data: { confirm: "Are you sure you want to delete this task?" } %></p>
          <p>Posted by: <%= User.find(review.user_id).username %> - <%= time_ago_in_words(review.created_at)%> ago</p>
        </div>
      <% end %>
    <% else %>
      <div class="card bg-light rounded mt-2 p-3 d-flex justify-content-center">
        <p>Be the first to leave a review</p>
      </div>
  <% end %>

</section>
